(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{655:function(s,t,a){s.exports=a.p+"assets/img/image-20201230150145488.84593fe3.png"},656:function(s,t,a){s.exports=a.p+"assets/img/image-20201230150643557.41150922.png"},657:function(s,t,a){s.exports=a.p+"assets/img/image-20201230170805917.ee62a4ed.png"},996:function(s,t,a){"use strict";a.r(t);var e=a(21),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"_01-工作负载控制器是什么"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_01-工作负载控制器是什么"}},[s._v("#")]),s._v(" 01.工作负载控制器是什么")]),s._v(" "),e("p",[s._v("工作负载控制器（Workload Controllers）是K8s的一个抽象概念，用于更高级层次对象，部署和管理Pod。")]),s._v(" "),e("p",[s._v("常用工作负载控制器：")]),s._v(" "),e("ul",[e("li",[s._v("Deployment ： 无状态应用部署")]),s._v(" "),e("li",[s._v("StatefulSet ： 有状态应用部署")]),s._v(" "),e("li",[s._v("DaemonSet ： 确保所有Node运行同一个Pod")]),s._v(" "),e("li",[s._v("Job ： 一次性任务")]),s._v(" "),e("li",[s._v("Cronjob ： 定时任务")])]),s._v(" "),e("p",[s._v("控制器的作用：")]),s._v(" "),e("ul",[e("li",[s._v("管理Pod对象")]),s._v(" "),e("li",[s._v("使用标签与Pod关联")]),s._v(" "),e("li",[s._v("控制器实现了Pod的运维，例如滚动更新、伸缩、副本管理、维护Pod状态等。")])]),s._v(" "),e("p",[e("img",{staticStyle:{width:"400px","margin-left":"20px"},attrs:{src:a(655)}})]),s._v(" "),e("h1",{attrs:{id:"_02-deployment"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_02-deployment"}},[s._v("#")]),s._v(" 02.Deployment")]),s._v(" "),e("h2",{attrs:{id:"_2-1-deployment功能介绍"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-deployment功能介绍"}},[s._v("#")]),s._v(" 2.1 Deployment功能介绍")]),s._v(" "),e("p",[s._v("本质：在升级时，杀掉旧的镜像，部署新镜像")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("Deployment的功能：")]),s._v(" "),e("ul",[e("li",[s._v("管理Pod和ReplicaSet")]),s._v(" "),e("li",[s._v("具有上线部署、副本6设定、滚动升级、回滚等功能")]),s._v(" "),e("li",[s._v("提供声明式更新，例如只更新一个新的Image")])])]),s._v(" "),e("li",[e("p",[s._v("应用场景：网站、API、微服务")])]),s._v(" "),e("li",[e("p",[s._v("项目生命周期")])])]),s._v(" "),e("p",[e("img",{staticStyle:{width:"800px","margin-left":"20px"},attrs:{src:a(656)}})]),s._v(" "),e("h2",{attrs:{id:"_2-2-部署nginx-1-15版本"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-部署nginx-1-15版本"}},[s._v("#")]),s._v(" 2.2 部署nginx 1.15版本")]),s._v(" "),e("div",{staticClass:"language-yaml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("master ~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim deployment.yaml")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" apps/v1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Deployment\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" web\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("namespace")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" default\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("replicas")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("selector")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("matchLabels")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("app")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("template")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("labels")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("app")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" web\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.15")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br")])]),e("div",{staticClass:"language-javascript line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# kubectl "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("delete")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("f "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("               # 一键卸载所有部署的服务（当前文件夹下所有部署文件）\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# kubectl apply "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("f deployment"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("yaml \n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# kubectl "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("get")]),s._v(" pods "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("o wide            # 确定pod是否被正确部署\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# kubectl expose deployment web "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("target"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("type"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("NodePort\nhttp"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token regex"}},[e("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[s._v("192.168.56.62:30610")]),e("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")])]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h2",{attrs:{id:"_2-3-deployment：滚动升级"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-deployment：滚动升级"}},[s._v("#")]),s._v(" 2.3 Deployment：滚动升级")]),s._v(" "),e("div",{staticClass:"language-javascript line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# kubectl "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("get")]),s._v(" ep\n"),e("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NAME")]),s._v("           "),e("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ENDPOINTS")]),s._v("                                "),e("span",{pre:!0,attrs:{class:"token constant"}},[s._v("AGE")]),s._v("\nkubernetes     "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v(".56")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v(".61")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("6443")]),s._v("                            "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("d2h\nnginx        "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.244")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v(".169")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v(".129")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.244")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v(".169")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v(".130")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.244")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v(".36")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v(".66")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("      "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("d\nweb          "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.244")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v(".169")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v(".129")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.244")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v(".169")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v(".130")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.244")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v(".36")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v(".66")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("     "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("m32s\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h3",{attrs:{id:"_2-3-1-修改-yaml文件升级"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-1-修改-yaml文件升级"}},[s._v("#")]),s._v(" 2.3.1 修改.yaml文件升级")]),s._v(" "),e("ul",[e("li",[s._v("直接修改deployment.yaml文件中 image: nginx:1.15修改成image: nginx:1.18")])]),s._v(" "),e("h3",{attrs:{id:"_1-3-2-kubectl-set命令行升级"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-2-kubectl-set命令行升级"}},[s._v("#")]),s._v(" 1.3.2 kubectl set命令行升级")]),s._v(" "),e("div",{staticClass:"language-javascript line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# kubectl "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" image deployment"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("web web"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.16")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# kubectl describe deployment web               # 确定是否已经升级为 nginx"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.16")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h2",{attrs:{id:"_2-4-deployment：水平扩缩容"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-deployment：水平扩缩容"}},[s._v("#")]),s._v(" 2.4 Deployment：水平扩缩容")]),s._v(" "),e("p",[e("img",{staticStyle:{width:"800px","margin-left":"20px"},attrs:{src:a(657)}})]),s._v(" "),e("h2",{attrs:{id:"_2-5-deployment：回滚"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-deployment：回滚"}},[s._v("#")]),s._v(" 2.5 Deployment：回滚")]),s._v(" "),e("div",{staticClass:"language-javascript line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1.查看当前pod升级历史记录 '")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# kubectl rollout history deployment web\ndeployment"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apps"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("web \n"),e("span",{pre:!0,attrs:{class:"token constant"}},[s._v("REVISION")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CHANGE")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),e("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CAUSE")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("         "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("#  kubectl rollout undo deployment"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("web               # 回滚上一个版本 \n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("#  kubectl rollout undo deployment"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("web "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("to"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("revision"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("     # 回滚历史指定版\n"),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2.可以看到pod回滚到了 nginx:1.5版本'")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# kubectl describe deployment web\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("h2",{attrs:{id:"_2-6-下线"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-6-下线"}},[s._v("#")]),s._v(" 2.6 下线")]),s._v(" "),e("div",{staticClass:"language-javascript line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("#  kubectl "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("delete")]),s._v(" deploy"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("web\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("#  kubectl "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("delete")]),s._v(" svc"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("web\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h1",{attrs:{id:"_03-daemonset"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_03-daemonset"}},[s._v("#")]),s._v(" 03.DaemonSet")]),s._v(" "),e("ul",[e("li",[s._v("在每一个Node上运行一个Pod")]),s._v(" "),e("li",[s._v("新加入的Node也同样会自动运行一个Pod")]),s._v(" "),e("li",[s._v("应用场景：网络插件（kube-proxy、calico）、其他Agent")])]),s._v(" "),e("h1",{attrs:{id:"_04-job"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_04-job"}},[s._v("#")]),s._v(" 04.Job")]),s._v(" "),e("p",[e("img",{staticStyle:{width:"800px","margin-left":"50px"},attrs:{src:"assets/image-20210127143027980.png"}})]),s._v(" "),e("h1",{attrs:{id:"_05-cronjob"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_05-cronjob"}},[s._v("#")]),s._v(" 05.CronJob")]),s._v(" "),e("p",[e("img",{staticStyle:{width:"700px","margin-left":"50px"},attrs:{src:"assets/image-20210127152914891.png"}})])])}),[],!1,null,null,null);t.default=n.exports}}]);