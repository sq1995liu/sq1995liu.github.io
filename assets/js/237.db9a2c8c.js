(window.webpackJsonp=window.webpackJsonp||[]).push([[237],{896:function(s,t,a){"use strict";a.r(t);var n=a(21),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"_1-docker基本原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-docker基本原理"}},[s._v("#")]),s._v(" 1.docker基本原理")]),s._v(" "),a("p",[s._v("https://www.cnblogs.com/xiaonq/p/10241045.html")]),s._v(" "),a("h3",{attrs:{id:"_1-1-毛线是docker？"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-毛线是docker？"}},[s._v("#")]),s._v(" 1.1 毛线是docker？")]),s._v(" "),a("ul",[a("li",[s._v("1.Docker是使用最广泛的"),a("code",[s._v("开源容器引擎")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("容器：")]),s._v(" "),a("ul",[a("li",[s._v("**1）**容器是一个操作系统级别下的虚拟化技术，运行一个容器就行运行一个进程一样")]),s._v(" "),a("li",[s._v("**2）**容器依赖linux内核特性：Namespace（资源隔离）和Cgroups（资源限制）")])])])])]),s._v(" "),a("li",[s._v("2.一种操作系统基本的"),a("code",[s._v("虚拟化技术")]),s._v(" "),a("ul",[a("li",[s._v("我们使用的VMware虚拟机就是虚拟化技术")]),s._v(" "),a("li",[s._v("一个操作系统下，虚拟出来，其他操作系统的机器")])])]),s._v(" "),a("li",[s._v("3.一种简单的应用"),a("code",[s._v("程序打包工具")])]),s._v(" "),a("li",[s._v("4.依赖Linux内核特性："),a("code",[s._v("Namespace(资源隔离)")]),s._v(" 和"),a("code",[s._v("Cgroup（资源限制）")])])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker run -itd -p 91:80 nginx\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_1-2-资源隔离和资源限制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-资源隔离和资源限制"}},[s._v("#")]),s._v(" 1.2 资源隔离和资源限制")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("资源隔离：")]),s._v(" "),a("ul",[a("li",[s._v("1）"),a("code",[s._v("Linux Namespaces")]),s._v("机制提供一种资源隔离方案，每个namespace看上去就像一个单独的Linux系统。")]),s._v(" "),a("li",[s._v("2）"),a("code",[s._v("PID")]),s._v(",IPC(进程通信),"),a("code",[s._v("Network")]),s._v("等系统资源不再是全局性的，而是属于某个特定的Namespace。")]),s._v(" "),a("li",[s._v("3）每个namespace下的"),a("code",[s._v("资源对于其他namespace")]),s._v("下的资源都是透明，"),a("code",[s._v("不可见的")]),s._v("。")]),s._v(" "),a("li",[s._v("4）系统中可以同时存在"),a("code",[s._v("两个进程号为0,1,2的进程")]),s._v("，由于"),a("code",[s._v("属于不同的namespace")]),s._v("，所以它们之间并不冲突。")]),s._v(" "),a("li",[s._v("5）而在用户层面上只能看到属于用户自己namespace下的资源，例如使用ps命令只能列出自己namespace下的进程。")]),s._v(" "),a("li",[s._v("6）这样"),a("code",[s._v("每个namespace看上去就像一个单独的Linux系统")]),s._v("。")])])]),s._v(" "),a("li",[a("p",[s._v("资源限制：")]),s._v(" "),a("ul",[a("li",[s._v("1）为了让容器中的进程更加可控，"),a("code",[s._v("Docker 使用 Linux cgroups 来限制容器中的进程允许使用的系统资源")]),s._v("。")]),s._v(" "),a("li",[s._v("2）可以在启动容器是指定每个容器可以使用的"),a("code",[s._v("网络、磁盘、CPU以及内存")]),s._v(" 等")])])])]),s._v(" "),a("h1",{attrs:{id:"_2-ubuntu安装docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-ubuntu安装docker"}},[s._v("#")]),s._v(" 2.ubuntu安装docker")]),s._v(" "),a("h3",{attrs:{id:"_2-1-安装docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-安装docker"}},[s._v("#")]),s._v(" 2.1 安装docker")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1.卸载旧版本")]),s._v("\nsudo apt"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("get remove docker docker"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("engine docker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io containerd runc\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2.更新ubuntu的apt源索引")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改apt国内源为中科大源")]),s._v("\nsudo cp "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("apt"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sources"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("list")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("apt"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sources"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("list")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("bak\nsudo sed "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("i "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/archive.ubuntu.com/mirrors.ustc.edu.cn/'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("apt"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sources"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("list")]),s._v("\nsudo apt update\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#3.安装包允许apt通过HTTPS使用仓库")]),s._v("\nsudo apt"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("get install \\\n    apt"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("transport"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("https \\\n    ca"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("certificates \\\n    curl \\\n    software"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("properties"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("common\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#4.添加Docker官方GPG key")]),s._v("\ncurl "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("fsSL https"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("//")]),s._v("download"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("docker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("linux"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("ubuntu"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("gpg "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" sudo apt"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("key add "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#5.设置Docker稳定版仓库（国内使用都用用国内的源）")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#5.1 设置使用阿里云")]),s._v("\nadd"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("apt"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("repository "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"deb [arch=amd64] https://mirrors.aliyun.com/docker-ce/linux/ubuntu $(lsb_release -cs) stable"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#5.2 设置使用官方，很慢(不建议用这个)")]),s._v("\nsudo add"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("apt"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v('repository \\\n   "deb '),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("arch"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("amd64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" https"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("//")]),s._v("download"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("docker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("linux"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("ubuntu \\\n   $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("lsb_release "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("cs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(' \\\n   stable"\n    \n'),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#6.添加仓库后，更新apt源索引")]),s._v("\nsudo apt"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("get update\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#7.安装最新版Docker CE（社区版）")]),s._v("\nsudo apt"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("get install docker"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ce\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#8.检查Docker CE是否安装正确")]),s._v("\nsudo docker run hello"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("world\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br")])]),a("h3",{attrs:{id:"_2-2-docker默认是国外源可以设置成国内镜像源"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-docker默认是国外源可以设置成国内镜像源"}},[s._v("#")]),s._v(" 2.2 docker默认是国外源可以设置成国内镜像源")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("root@linux"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("node1 django"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("docker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim /etc/docker/daemon.json    # 设置docker镜像源")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"registry-mirrors"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://hub-mirror.c.163.com"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n或者\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"registry-mirrors"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://docker.mirrors.ustc.edu.cn"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("node2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl daemon-reload                   # 重载文件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("node2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl restart docker                  # 重启docker生效")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h3",{attrs:{id:"_2-3-docker启动设置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-docker启动设置"}},[s._v("#")]),s._v(" 2.3 docker启动设置")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动Docker服务并设置开机启动")]),s._v("\nsystemctl start docker\nsystemctl enable docker\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h3",{attrs:{id:"_2-4-docker简单使用（创建一个ngixn容器）"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-docker简单使用（创建一个ngixn容器）"}},[s._v("#")]),s._v(" 2.4 docker简单使用（创建一个ngixn容器）")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1、创建一个nginx容器")]),s._v("\n docker run "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("it nginx\n \n "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2、查看docker运行的容器(可以获取到这个容器的id)")]),s._v("\n docker ps\n \n "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3、访问这个容器")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入这个nginx容器（进入的文件系统和宿主机是完全隔离的，有自己独立的文件系统）")]),s._v("\n docker "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("it "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("73877e65c07d")]),s._v(" bash\n \n "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4、查看当前容器的 IP")]),s._v("\n docker inspect "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("73877e65c07d")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 73877e65c07d是通过docekr ps查看到的容器ID")]),s._v("\n curl "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".2")]),s._v("               "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试这个nginx容器是否可以访问")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])])])}),[],!1,null,null,null);t.default=e.exports}}]);