(window.webpackJsonp=window.webpackJsonp||[]).push([[132],{612:function(s,t,a){s.exports=a.p+"assets/img/image-20200308115655548.f08e69a0.png"},979:function(s,t,a){"use strict";a.r(t);var n=a(21),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"_01-什么是dockerfile-（what）"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_01-什么是dockerfile-（what）"}},[s._v("#")]),s._v(" 01.什么是dockerfile?（What）")]),s._v(" "),n("h3",{attrs:{id:"_1-1-dockerfile是什么"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-dockerfile是什么"}},[s._v("#")]),s._v(" 1.1 dockerfile是什么?")]),s._v(" "),n("ul",[n("li",[s._v("Dockerfile是用来构建Docker镜像的构建文件，是由一系列命令和参数构成的脚本。")]),s._v(" "),n("li",[s._v("构建三步骤")]),s._v(" "),n("li",[n("img",{staticStyle:{width:"600px","margin-left":"0px"},attrs:{src:a(612)}})])]),s._v(" "),n("h3",{attrs:{id:"_1-2-dockerfile语法说明"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-dockerfile语法说明"}},[s._v("#")]),s._v(" 1.2 dockerfile语法说明")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v("'''1.DOckerfile常用命令 '''")]),s._v("\n\nFROM python"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.6")]),s._v("                     "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定拉取镜像版本")]),s._v("\nENV PYTHONUNBUFFERED "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("              "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 不缓冲stdin、stdout和stderr，直接把输出重定向到文件")]),s._v("\nMAINITAINER zhangsan                "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定作者")]),s._v("\nRUN mkdri "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("code                     "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建文件夹")]),s._v("\nWORKDIR "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("code                       "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定项目工作根路径")]),s._v("\nADD "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("code"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("                        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 不仅可以拷贝宿主机或者docker中的文件还可以下载网上的（add http://www.exaple.com/down）")]),s._v("\nCOPY dj"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("conf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("d         "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将宿主机文件或docker内部文件拷贝")]),s._v("\nVOLUME "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/data1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/data2"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("            "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将宿主机文件夹挂载到容器中")]),s._v("\nEXPOSE "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("                       "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 暴露端口")]),s._v("\nCMD "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sh"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/code/start.sh"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("            "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 容器启动时要运行的命令")]),s._v("\nCMD "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"python"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"manage.py"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"runserver"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0:8000"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("ul",[n("li",[s._v("生成镜像并运行容器")])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v("'''2.生成镜像并运行容器'''")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("node2 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker build -t nginx:v1 -f Dockerfile-nginx .         # 使用Dockerfile-nginx文件生成镜像 nginx:v1")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("node2 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker push linux-node4.example.com/test/nginx:v1      # 推送镜像到harbor中")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("node2 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d -p 192.168.56.14:8000:8080 nginx:v1      # 运行docker容器")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h3",{attrs:{id:"_1-3-nginx测试dockerfile"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-nginx测试dockerfile"}},[s._v("#")]),s._v(" 1.3 nginx测试dockerfile")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("FROM nginx:v1\nCOPY index.html  /usr/local/nginx/html   # 需要在当前目录中创建index.html文件\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])])])}),[],!1,null,null,null);t.default=e.exports}}]);