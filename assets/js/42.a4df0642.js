(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{628:function(s,t,a){s.exports=a.p+"assets/img/image-20201219123455814.4fabe222.png"},629:function(s,t,a){s.exports=a.p+"assets/img/image-20201219135615226.7f716d2b.png"},630:function(s,t,a){s.exports=a.p+"assets/img/image-20201219140102042.1485838b.png"},988:function(s,t,a){"use strict";a.r(t);var r=a(21),n=Object(r.a)({},(function(){var s=this,t=s.$createElement,r=s._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[r("h2",{attrs:{id:"_01-部署webui仪表盘"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_01-部署webui仪表盘"}},[s._v("#")]),s._v(" 01.部署WebUI仪表盘")]),s._v(" "),r("h3",{attrs:{id:"_1-1-webui仪表盘官网"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-webui仪表盘官网"}},[s._v("#")]),s._v(" 1.1 WebUI仪表盘官网")]),s._v(" "),r("ul",[r("li",[s._v("官网地址：https://kubernetes.io/docs/tasks/access-application-cluster/web-ui-dashboard/")]),s._v(" "),r("li",[s._v("GitHub地址：https://github.com/kubernetes/dashboard")]),s._v(" "),r("li",[r("img",{staticStyle:{width:"800px","margin-left":"20px"},attrs:{src:a(628)}})])]),s._v(" "),r("h3",{attrs:{id:"_1-2-安装webui"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-安装webui"}},[s._v("#")]),s._v(" 1.2 安装WebUI")]),s._v(" "),r("div",{staticClass:"language-javascript line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-javascript"}},[r("code",[r("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),r("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1.下载WebUI配置文件 '")]),r("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master1 "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("## wget https"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("raw"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("githubusercontent"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("kubernetes"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("dashboard"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("v2"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("aio"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("deploy"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("recommended"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("yaml\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master1 "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("## mv recommended"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("yaml dashboard"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("yaml\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master1 "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("## vim "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("root"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("dashboard"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("yaml \n## 这个是官方原始配置，默认使用 kubectl proxy代理模式\nspec"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n  ports"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n    "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" port"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v("\n      targetPort"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("8443")]),s._v("\n  selector"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n    k8s"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("app"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" kubernetes"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dashboard\n\n## 需要将上面的配置添加两个产生：type"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" NodePort 和 nodePort"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("30001")]),s._v(" \nspec"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n  type"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" NodePort                ## 官方默认使用 kubectl proxy代理模式，这里我们修改成NodePort模式\n  ports"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n    "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" port"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v("\n      targetPort"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("8443")]),s._v("\n      nodePort"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("30001")]),s._v("           ## 添加nodePort暴露端口为，"),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("30001")]),s._v("\n  selector"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n    k8s"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("app"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" kubernetes"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dashboard\n\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master1 "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("## kubectl apply "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("f dashboard"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("yaml     ## 执行部署WebUI命令\nnamespace"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("kubernetes"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dashboard created           ## 可以看到输出的信息，命名空间被修改成了，kubernetes"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dashboard\nserviceaccount"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("kubernetes"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dashboard created\nservice"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("kubernetes"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dashboard created\nsecret"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("kubernetes"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dashboard"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("certs created\nsecret"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("kubernetes"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dashboard"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("csrf created\nsecret"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("kubernetes"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dashboard"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("key"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("holder created\nconfigmap"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("kubernetes"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dashboard"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("settings created\nrole"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rbac"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("authorization"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("k8s"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("kubernetes"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dashboard created\nclusterrole"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rbac"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("authorization"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("k8s"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("kubernetes"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dashboard created\nrolebinding"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rbac"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("authorization"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("k8s"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("kubernetes"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dashboard created\nclusterrolebinding"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rbac"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("authorization"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("k8s"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("kubernetes"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dashboard created\ndeployment"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apps"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("kubernetes"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dashboard created\nservice"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("dashboard"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("metrics"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("scraper created\ndeployment"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apps"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("dashboard"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("metrics"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("scraper created\n"),r("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),r("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1.可以看到创建了两个 pod容器，由于需要拉取官方镜像，所以其中一个状态是：ContainerCreating，需要等待 '")]),r("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master1 "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("## kubectl "),r("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("get")]),s._v(" pods "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("n kubernetes"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dashboard\n"),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NAME")]),s._v("                                        "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("READY")]),s._v("   "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("STATUS")]),s._v("              "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("RESTARTS")]),s._v("   "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("AGE")]),s._v("\ndashboard"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("metrics"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("scraper"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("c79c65bb7"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("rpk6c   "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("     ContainerCreating   "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("m22s\nkubernetes"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dashboard"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("56484")]),s._v("d4c5"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("kxsw        "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("     Running             "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("m22s\n \n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master1 "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("## kubectl "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("namespace"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("kubernetes"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dashboard describe pod dashboard"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("metrics"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("scraper"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("c79c65bb7"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("rpk6c\nWarning  Failed    kubelet"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" k8s"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("node1  Error"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" ErrImagePull\nNormal   BackOff   kubelet"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" k8s"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("node1  Back"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("off pulling image "),r("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kubernetesui/dashboard:v2.0.0"')]),s._v("\nWarning  Failed    kubelet"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" k8s"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("node1  Error"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" ImagePullBackOff\nNormal   Pulling   kubelet"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" k8s"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("node1  Pulling image "),r("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kubernetesui/dashboard:v2.0.0"')]),s._v("  ## ContainerCreating原因很清晰，还在下载镜像\n## 注：如果长时间下载不成功，可以到对应node节点中，修改 "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("docker"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("daemon"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("json 添加国内镜像加速地址\n\n"),r("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),r("span",{pre:!0,attrs:{class:"token string"}},[s._v("'经过一段时间等待，两个容器的状态重要变成 Running状态  '")]),r("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master1 "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("## kubectl "),r("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("get")]),s._v(" pods "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("n kubernetes"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dashboard\n"),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NAME")]),s._v("                                        "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("READY")]),s._v("   "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("STATUS")]),s._v("    "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("RESTARTS")]),s._v("   "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("AGE")]),s._v("\ndashboard"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("metrics"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("scraper"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("c79c65bb7"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("rpk6c   "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("     Running   "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v("m\nkubernetes"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dashboard"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("56484")]),s._v("d4c5"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("kxsw        "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("     Running   "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v("m\n\n "),r("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),r("span",{pre:!0,attrs:{class:"token string"}},[s._v("'查看WebUI对外暴露的端口'")]),r("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master1 "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("## kubectl "),r("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("get")]),s._v(" pods"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("svc "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("n kubernetes"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dashboard\n"),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NAME")]),s._v("                       "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("TYPE")]),s._v("      "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CLUSTER")]),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("IP")]),s._v("   "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("EXTERNAL")]),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("IP")]),s._v("   "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("PORT")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("S")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("       "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("AGE")]),s._v("\nservice"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("dashboard"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("metrics"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("scraper   ClusterIP   "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v(".31")]),s._v("    "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("      "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("TCP")]),s._v("      "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v("m\nservice"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("kubernetes"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dashboard      NodePort   "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v(".219")]),s._v("    "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("      "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("30001")]),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("TCP")]),s._v("   "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v("m\n\n")])]),s._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[s._v("1")]),r("br"),r("span",{staticClass:"line-number"},[s._v("2")]),r("br"),r("span",{staticClass:"line-number"},[s._v("3")]),r("br"),r("span",{staticClass:"line-number"},[s._v("4")]),r("br"),r("span",{staticClass:"line-number"},[s._v("5")]),r("br"),r("span",{staticClass:"line-number"},[s._v("6")]),r("br"),r("span",{staticClass:"line-number"},[s._v("7")]),r("br"),r("span",{staticClass:"line-number"},[s._v("8")]),r("br"),r("span",{staticClass:"line-number"},[s._v("9")]),r("br"),r("span",{staticClass:"line-number"},[s._v("10")]),r("br"),r("span",{staticClass:"line-number"},[s._v("11")]),r("br"),r("span",{staticClass:"line-number"},[s._v("12")]),r("br"),r("span",{staticClass:"line-number"},[s._v("13")]),r("br"),r("span",{staticClass:"line-number"},[s._v("14")]),r("br"),r("span",{staticClass:"line-number"},[s._v("15")]),r("br"),r("span",{staticClass:"line-number"},[s._v("16")]),r("br"),r("span",{staticClass:"line-number"},[s._v("17")]),r("br"),r("span",{staticClass:"line-number"},[s._v("18")]),r("br"),r("span",{staticClass:"line-number"},[s._v("19")]),r("br"),r("span",{staticClass:"line-number"},[s._v("20")]),r("br"),r("span",{staticClass:"line-number"},[s._v("21")]),r("br"),r("span",{staticClass:"line-number"},[s._v("22")]),r("br"),r("span",{staticClass:"line-number"},[s._v("23")]),r("br"),r("span",{staticClass:"line-number"},[s._v("24")]),r("br"),r("span",{staticClass:"line-number"},[s._v("25")]),r("br"),r("span",{staticClass:"line-number"},[s._v("26")]),r("br"),r("span",{staticClass:"line-number"},[s._v("27")]),r("br"),r("span",{staticClass:"line-number"},[s._v("28")]),r("br"),r("span",{staticClass:"line-number"},[s._v("29")]),r("br"),r("span",{staticClass:"line-number"},[s._v("30")]),r("br"),r("span",{staticClass:"line-number"},[s._v("31")]),r("br"),r("span",{staticClass:"line-number"},[s._v("32")]),r("br"),r("span",{staticClass:"line-number"},[s._v("33")]),r("br"),r("span",{staticClass:"line-number"},[s._v("34")]),r("br"),r("span",{staticClass:"line-number"},[s._v("35")]),r("br"),r("span",{staticClass:"line-number"},[s._v("36")]),r("br"),r("span",{staticClass:"line-number"},[s._v("37")]),r("br"),r("span",{staticClass:"line-number"},[s._v("38")]),r("br"),r("span",{staticClass:"line-number"},[s._v("39")]),r("br"),r("span",{staticClass:"line-number"},[s._v("40")]),r("br"),r("span",{staticClass:"line-number"},[s._v("41")]),r("br"),r("span",{staticClass:"line-number"},[s._v("42")]),r("br"),r("span",{staticClass:"line-number"},[s._v("43")]),r("br"),r("span",{staticClass:"line-number"},[s._v("44")]),r("br"),r("span",{staticClass:"line-number"},[s._v("45")]),r("br"),r("span",{staticClass:"line-number"},[s._v("46")]),r("br"),r("span",{staticClass:"line-number"},[s._v("47")]),r("br"),r("span",{staticClass:"line-number"},[s._v("48")]),r("br"),r("span",{staticClass:"line-number"},[s._v("49")]),r("br"),r("span",{staticClass:"line-number"},[s._v("50")]),r("br"),r("span",{staticClass:"line-number"},[s._v("51")]),r("br"),r("span",{staticClass:"line-number"},[s._v("52")]),r("br"),r("span",{staticClass:"line-number"},[s._v("53")]),r("br"),r("span",{staticClass:"line-number"},[s._v("54")]),r("br"),r("span",{staticClass:"line-number"},[s._v("55")]),r("br"),r("span",{staticClass:"line-number"},[s._v("56")]),r("br"),r("span",{staticClass:"line-number"},[s._v("57")]),r("br"),r("span",{staticClass:"line-number"},[s._v("58")]),r("br"),r("span",{staticClass:"line-number"},[s._v("59")]),r("br"),r("span",{staticClass:"line-number"},[s._v("60")]),r("br"),r("span",{staticClass:"line-number"},[s._v("61")]),r("br"),r("span",{staticClass:"line-number"},[s._v("62")]),r("br")])]),r("h3",{attrs:{id:"_1-3-为webui生成认证token"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-为webui生成认证token"}},[s._v("#")]),s._v(" 1.3  为WebUI生成认证Token")]),s._v(" "),r("ul",[r("li",[s._v("==将 dashboard-adminuser.yaml 文件上传到 k8s-master1 的 /root/ 文件夹下==")])]),s._v(" "),r("div",{staticClass:"language-javascript line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-javascript"}},[r("code",[r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master1 "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("## vim "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("root"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("dashboard"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("adminuser"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("yaml \n\napiVersion"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" v1\nkind"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" ServiceAccount                 ## 首先创建一个 ServiceAccount，token都是由ServiceAccount创建\nmetadata"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n  name"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" admin"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("user\n  namespace"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" kubernetes"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dashboard\n"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("\napiVersion"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" rbac"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("authorization"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("k8s"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("v1\nkind"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" ClusterRoleBinding\nmetadata"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n  name"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" admin"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("user\nroleRef"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n  apiGroup"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" rbac"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("authorization"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("k8s"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io\n  kind"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" ClusterRole\n  name"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" cluster"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("admin                ## 将ServiceAccount授权，加入到 cluster"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("amdin组中，这个组具有对k8s超级管理员权限\nsubjects"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" kind"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" ServiceAccount\n  name"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" admin"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("user\n  namespace"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" kubernetes"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dashboard\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master1 "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("## kubectl apply "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("f dashboard"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("adminuser"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("yaml       ## 执行创建用户命令\nserviceaccount"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("admin"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("user created\nclusterrolebinding"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rbac"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("authorization"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("k8s"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("admin"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("user created\n\n"),r("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),r("span",{pre:!0,attrs:{class:"token string"}},[s._v("'创建完成后，可以通过下面命令获取到token '")]),r("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master1 "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("## kubectl "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("n kubernetes"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dashboard describe secret "),r("span",{pre:!0,attrs:{class:"token function"}},[s._v("$")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("kubectl "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("n kubernetes"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dashboard "),r("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("get")]),s._v(" secret "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" grep admin"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("user "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" awk "),r("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{print $1}'")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n token"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("      eyJhbGciOiJSUzI1NiIsImtpZCI6IlVxY0FtRThTcmN2V2tpS0s4VF8za2xTUzUtOUhHdlUyeUhIcWdNVTNFODAifQ"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlcm5ldGVzLWRhc2hib2FyZCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJhZG1pbi11c2VyLXRva2VuLXFsc2NoIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6ImFkbWluLXVzZXIiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC51aWQiOiJjZDMxNjQ3NS04NThiLTRiMDYtODc0Yi0yY2Q2MmI0YzQ5YWMiLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6a3ViZXJuZXRlcy1kYXNoYm9hcmQ6YWRtaW4tdXNlciJ9"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("n9JFgi9jeucrwAnXSj5ZCmIZLwzxCheTsrrC9gkXm6NBMAhPet3pQZTTN5YOMX"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("POn"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("CQUEFyM9b8Ulk5h94BMalg5jbEmUCgJWXjOUsSudTYvB8m_Xa92rnA6Lo8qRLQWpXfKE6NoAO0MYvRKLBMxL"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Oj4II"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("_DTsbd9bU1lkACR2_vG3Z1pPLDmsfCpBaGfcNg9IIWdHffFYOFgzlvjAue6qizblvosfX"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("QVcj3UKUd84IlYxVeqb4DdiITVjKk6L0269sMngc9oPFu0HvKDvgVm3ArZZ9HZFJgRnOrpVE6GVG1KKgk1X"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("B8hAVN"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("rSXgkGRNFnprT_RDx0BlWg\n")])]),s._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[s._v("1")]),r("br"),r("span",{staticClass:"line-number"},[s._v("2")]),r("br"),r("span",{staticClass:"line-number"},[s._v("3")]),r("br"),r("span",{staticClass:"line-number"},[s._v("4")]),r("br"),r("span",{staticClass:"line-number"},[s._v("5")]),r("br"),r("span",{staticClass:"line-number"},[s._v("6")]),r("br"),r("span",{staticClass:"line-number"},[s._v("7")]),r("br"),r("span",{staticClass:"line-number"},[s._v("8")]),r("br"),r("span",{staticClass:"line-number"},[s._v("9")]),r("br"),r("span",{staticClass:"line-number"},[s._v("10")]),r("br"),r("span",{staticClass:"line-number"},[s._v("11")]),r("br"),r("span",{staticClass:"line-number"},[s._v("12")]),r("br"),r("span",{staticClass:"line-number"},[s._v("13")]),r("br"),r("span",{staticClass:"line-number"},[s._v("14")]),r("br"),r("span",{staticClass:"line-number"},[s._v("15")]),r("br"),r("span",{staticClass:"line-number"},[s._v("16")]),r("br"),r("span",{staticClass:"line-number"},[s._v("17")]),r("br"),r("span",{staticClass:"line-number"},[s._v("18")]),r("br"),r("span",{staticClass:"line-number"},[s._v("19")]),r("br"),r("span",{staticClass:"line-number"},[s._v("20")]),r("br"),r("span",{staticClass:"line-number"},[s._v("21")]),r("br"),r("span",{staticClass:"line-number"},[s._v("22")]),r("br"),r("span",{staticClass:"line-number"},[s._v("23")]),r("br"),r("span",{staticClass:"line-number"},[s._v("24")]),r("br"),r("span",{staticClass:"line-number"},[s._v("25")]),r("br"),r("span",{staticClass:"line-number"},[s._v("26")]),r("br"),r("span",{staticClass:"line-number"},[s._v("27")]),r("br")])]),r("h3",{attrs:{id:"_1-4-访问webui"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-访问webui"}},[s._v("#")]),s._v(" 1.4 访问WebUI")]),s._v(" "),r("ul",[r("li",[r("p",[r("code",[s._v("访问地址：")]),s._v("https://192.168.56.65:30001/      （任意node节点地址都可以访问）")])]),s._v(" "),r("li",[r("p",[r("img",{staticStyle:{width:"900px","margin-left":"0px"},attrs:{src:a(629)}})])]),s._v(" "),r("li",[r("p",[r("img",{staticStyle:{width:"900px","margin-left":"0px"},attrs:{src:a(630)}})])])]),s._v(" "),r("h2",{attrs:{id:"_02-部署k8s集群内部dns"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_02-部署k8s集群内部dns"}},[s._v("#")]),s._v(" 02.部署K8S集群内部DNS")]),s._v(" "),r("h3",{attrs:{id:"_2-1-集群内部dns说明"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-集群内部dns说明"}},[s._v("#")]),s._v(" 2.1 集群内部DNS说明")]),s._v(" "),r("ul",[r("li",[r("p",[s._v("是为了内部 service 提供 DNS解析的")])]),s._v(" "),r("li",[r("p",[s._v("部署完DNS后就可以使用 服务名称 来转发到后面的 pod中")])]),s._v(" "),r("li",[r("p",[s._v("如果部署DNS那就必须使用 10.0.0.221 这些内部IP来访问，在程序中只能写死，不方便")])]),s._v(" "),r("li",[r("div",{staticClass:"language-javascript line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-javascript"}},[r("code",[s._v("   "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master1 "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("## kubectl "),r("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("get")]),s._v(" svc\n   "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NAME")]),s._v("         "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("TYPE")]),s._v("      "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CLUSTER")]),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("IP")]),s._v("      "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("EXTERNAL")]),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("IP")]),s._v("   "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("PORT")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("S")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("        "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("AGE")]),s._v("\n   kubernetes   ClusterIP    "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),s._v("        "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("      "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("TCP")]),s._v("        "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v("h\n   web         NodePort    "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v(".221")]),s._v("      "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("      "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("30464")]),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("TCP")]),s._v("     "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v("h\n")])]),s._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[s._v("1")]),r("br"),r("span",{staticClass:"line-number"},[s._v("2")]),r("br"),r("span",{staticClass:"line-number"},[s._v("3")]),r("br"),r("span",{staticClass:"line-number"},[s._v("4")]),r("br")])])]),s._v(" "),r("li",[r("p",[s._v("coredns如果使用的是kubeadm部署，会自动部署好，我们使用二进制部署，所以需要单独安装一下")])])]),s._v(" "),r("h3",{attrs:{id:"_2-2-安装-coredns"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-安装-coredns"}},[s._v("#")]),s._v(" 2.2 安装 coredns")]),s._v(" "),r("p",[s._v("==将 coredns.yaml 上传到 k8s-master1 的 /root/ 文件夹下==")]),s._v(" "),r("div",{staticClass:"language-javascript line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-javascript"}},[r("code",[r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master1 "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("## cat "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("root"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("coredns"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("yaml \n \nspec"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n  selector"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n    k8s"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("app"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" kube"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dns\n  ## 配置文件中最重要的就是 clusterIP"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("这个ip是我们为dns服务单独固定下来的一个ip，kubelet就是通过这个ip向他发送请求\n  clusterIP"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v(".2")]),s._v("       ## 所有node节点的 "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("opt"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("kubernetes"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("cfg"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("kubelet"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf 都配置了"),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v(".2")]),s._v(" 作为clusterDNS\n")])]),s._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[s._v("1")]),r("br"),r("span",{staticClass:"line-number"},[s._v("2")]),r("br"),r("span",{staticClass:"line-number"},[s._v("3")]),r("br"),r("span",{staticClass:"line-number"},[s._v("4")]),r("br"),r("span",{staticClass:"line-number"},[s._v("5")]),r("br"),r("span",{staticClass:"line-number"},[s._v("6")]),r("br"),r("span",{staticClass:"line-number"},[s._v("7")]),r("br")])]),r("div",{staticClass:"language-javascript line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-javascript"}},[r("code",[r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master1 "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("## kubectl apply "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("f coredns"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("yaml \nserviceaccount"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("coredns created\nclusterrole"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rbac"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("authorization"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("k8s"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("system"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("coredns created\nclusterrolebinding"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rbac"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("authorization"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("k8s"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("system"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("coredns created\nconfigmap"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("coredns created\ndeployment"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apps"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("coredns created\nservice"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("kube"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dns created\n\n"),r("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),r("span",{pre:!0,attrs:{class:"token string"}},[s._v("'查看coredns还在ContainerCreating状态 '")]),r("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master1 "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("## kubectl "),r("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("get")]),s._v(" pods "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("n kube"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("system\n"),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NAME")]),s._v("                  "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("READY")]),s._v("   "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("STATUS")]),s._v("              "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("RESTARTS")]),s._v("   "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("AGE")]),s._v("\ncoredns"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("d8cfdd59d"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("mbkzq     "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("     ContainerCreating   "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("42")]),s._v("s\nkube"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("flannel"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ds"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("amd64"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ptsbg   "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("     Running             "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("          "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("h\nkube"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("flannel"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ds"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("amd64"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("q2bt9   "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("     Running             "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("          "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("h\n"),r("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),r("span",{pre:!0,attrs:{class:"token string"}},[s._v("'查看pod详情，已经开始启动了 '")]),r("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master1 "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("## kubectl "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("namespace"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("kube"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("system describe pod coredns"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("d8cfdd59d"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("mbkzq\n Normal  Pulling    "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("109")]),s._v("s      kubelet"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" k8s"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("node2  Pulling image "),r("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lizhenliang/coredns:1.2.2"')]),s._v("\n Normal  Pulled     "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("65")]),s._v("s       kubelet"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" k8s"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("node2  Successfully pulled image "),r("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lizhenliang/coredns:1.2.2"')]),s._v("\n Normal  Created    "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("65")]),s._v("s       kubelet"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" k8s"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("node2  Created container coredns\n Normal  Started    "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("65")]),s._v("s       kubelet"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" k8s"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("node2  Started container coredns\n")])]),s._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[s._v("1")]),r("br"),r("span",{staticClass:"line-number"},[s._v("2")]),r("br"),r("span",{staticClass:"line-number"},[s._v("3")]),r("br"),r("span",{staticClass:"line-number"},[s._v("4")]),r("br"),r("span",{staticClass:"line-number"},[s._v("5")]),r("br"),r("span",{staticClass:"line-number"},[s._v("6")]),r("br"),r("span",{staticClass:"line-number"},[s._v("7")]),r("br"),r("span",{staticClass:"line-number"},[s._v("8")]),r("br"),r("span",{staticClass:"line-number"},[s._v("9")]),r("br"),r("span",{staticClass:"line-number"},[s._v("10")]),r("br"),r("span",{staticClass:"line-number"},[s._v("11")]),r("br"),r("span",{staticClass:"line-number"},[s._v("12")]),r("br"),r("span",{staticClass:"line-number"},[s._v("13")]),r("br"),r("span",{staticClass:"line-number"},[s._v("14")]),r("br"),r("span",{staticClass:"line-number"},[s._v("15")]),r("br"),r("span",{staticClass:"line-number"},[s._v("16")]),r("br"),r("span",{staticClass:"line-number"},[s._v("17")]),r("br"),r("span",{staticClass:"line-number"},[s._v("18")]),r("br"),r("span",{staticClass:"line-number"},[s._v("19")]),r("br"),r("span",{staticClass:"line-number"},[s._v("20")]),r("br")])]),r("h3",{attrs:{id:"_2-3-测试coredns是否可以解析"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-测试coredns是否可以解析"}},[s._v("#")]),s._v(" 2.3 测试coredns是否可以解析")]),s._v(" "),r("h4",{attrs:{id:"_2-3-1-启动busybox容器"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-1-启动busybox容器"}},[s._v("#")]),s._v(" 2.3.1 启动busybox容器")]),s._v(" "),r("ul",[r("li",[r("p",[s._v("==将 bs.yaml 上传到 k8s-master1 的 /root/ 文件中==")])]),s._v(" "),r("li",[r("p",[s._v("busybox 这个镜像是一个测试小工具")])])]),s._v(" "),r("div",{staticClass:"language-javascript line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-javascript"}},[r("code",[r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master1 "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("## kubectl apply "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("f bs"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("yaml \npod"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("busybox created\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master1 "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("## kubectl "),r("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("get")]),s._v(" pods "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("o wide    ## 等待镜像启动成功，下面显示还是 ContainerCreating 状态\n"),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NAME")]),s._v("             "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("READY")]),s._v("   "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("STATUS")]),s._v("       "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("RESTARTS")]),s._v("   "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("AGE")]),s._v("   "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("IP")]),s._v("         "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NODE")]),s._v("     "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NOMINATED")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NODE")]),s._v("   "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("READINESS")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("GATES")]),s._v("\nbusybox           "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("   ContainerCreating   "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("52")]),s._v("s   "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("     k8s"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("node2   "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("         "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nweb"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("d86c95cc9"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("wk82  "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("    Running         "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v("h   "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.244")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v(".5")]),s._v("  k8s"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("node2   "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("         "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[s._v("1")]),r("br"),r("span",{staticClass:"line-number"},[s._v("2")]),r("br"),r("span",{staticClass:"line-number"},[s._v("3")]),r("br"),r("span",{staticClass:"line-number"},[s._v("4")]),r("br"),r("span",{staticClass:"line-number"},[s._v("5")]),r("br"),r("span",{staticClass:"line-number"},[s._v("6")]),r("br")])]),r("h4",{attrs:{id:"_2-3-2-使用-busybox-的pod来测试dns"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-2-使用-busybox-的pod来测试dns"}},[s._v("#")]),s._v(" 2.3.2 使用 busybox 的pod来测试dns")]),s._v(" "),r("div",{staticClass:"language-javascript line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-javascript"}},[r("code",[r("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),r("span",{pre:!0,attrs:{class:"token string"}},[s._v("'可以看到集群中启动了一个pod： 名字：web ==》 IP：10.0.0.221 '")]),r("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master1 "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("## kubectl "),r("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("get")]),s._v(" svc\n"),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NAME")]),s._v("         "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("TYPE")]),s._v("        "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CLUSTER")]),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("IP")]),s._v("   "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("EXTERNAL")]),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("IP")]),s._v("   "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("PORT")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("S")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("        "),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("AGE")]),s._v("\nweb          NodePort    "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v(".221")]),s._v("   "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("        "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("30464")]),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("TCP")]),s._v("   "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v("h\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master1 "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("## kubectl exec "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("it busybox sh      ## 进入 busybox 容器内部\n"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" ## ping web                                ## 可以看到能够使用名字 web来 ping通 "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v(".221")]),s._v("，证明dns有效\n"),r("span",{pre:!0,attrs:{class:"token constant"}},[s._v("PING")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token function"}},[s._v("web")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v(".221")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("56")]),s._v(" data bytes\n"),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" bytes "),r("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v(".221")]),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" seq"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" ttl"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" time"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.034")]),s._v(" ms\n"),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" bytes "),r("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v(".221")]),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" seq"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" ttl"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" time"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.078")]),s._v(" ms\n")])]),s._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[s._v("1")]),r("br"),r("span",{staticClass:"line-number"},[s._v("2")]),r("br"),r("span",{staticClass:"line-number"},[s._v("3")]),r("br"),r("span",{staticClass:"line-number"},[s._v("4")]),r("br"),r("span",{staticClass:"line-number"},[s._v("5")]),r("br"),r("span",{staticClass:"line-number"},[s._v("6")]),r("br"),r("span",{staticClass:"line-number"},[s._v("7")]),r("br"),r("span",{staticClass:"line-number"},[s._v("8")]),r("br"),r("span",{staticClass:"line-number"},[s._v("9")]),r("br")])])])}),[],!1,null,null,null);t.default=n.exports}}]);