(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{647:function(s,t,a){s.exports=a.p+"assets/img/image-20201229141427818.e1c714dd.png"},648:function(s,t,a){s.exports=a.p+"assets/img/image-20201229223347960.74b58143.png"},649:function(s,t,a){s.exports=a.p+"assets/img/image-20201229224810728.a9c59d6c.png"},994:function(s,t,a){"use strict";a.r(t);var n=a(21),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"_01-深入理解pod对象：基本管理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_01-深入理解pod对象：基本管理"}},[s._v("#")]),s._v(" 01.深入理解Pod对象：基本管理")]),s._v(" "),n("h2",{attrs:{id:"_1-1-pod基本概念"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-pod基本概念"}},[s._v("#")]),s._v(" 1.1 Pod基本概念")]),s._v(" "),n("ul",[n("li",[n("code",[s._v("Pod是Kubernetes创建和管理的最小单元")]),s._v("，"),n("code",[s._v("一个Pod由一个容器 或多个容器组成")]),s._v("，这些容器共享存储、网络。")]),s._v(" "),n("li",[s._v("Pod特点：\n"),n("ul",[n("li",[s._v("一个Pod可以理解为是"),n("code",[s._v("一个应用实例")]),s._v("，提供服务")]),s._v(" "),n("li",[s._v("Pod中容器始终部署在一个Node上")]),s._v(" "),n("li",[s._v("Pod中容器共享网络、存储资源")]),s._v(" "),n("li",[n("code",[s._v("Kubernetes直接管理Pod")]),s._v("，而不是容器")])])])]),s._v(" "),n("h2",{attrs:{id:"_1-2-pod存在的意义"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-pod存在的意义"}},[s._v("#")]),s._v(" 1.2 Pod存在的意义")]),s._v(" "),n("ul",[n("li",[s._v("Pod主要用法：\n"),n("ul",[n("li",[n("code",[s._v("运行单个容器：")]),s._v("最常见的用法，在这种情况下，可以==将Pod看做是单个容器的抽象封装==")]),s._v(" "),n("li",[n("code",[s._v("运行多个容器：")]),s._v("==封装多个紧密耦合且需要共享资源的应用程序==")])])]),s._v(" "),n("li",[s._v("如果有这些需求，你可以一个pod运行多个容器：\n"),n("ul",[n("li",[s._v("两个应用之间发生文件交互")]),s._v(" "),n("li",[s._v("两个应用需要通过127.0.0.1或者socket通信")]),s._v(" "),n("li",[s._v("两个应用需要发生频繁的调用")])])])]),s._v(" "),n("h2",{attrs:{id:"_1-3-pod资源共享实现机制"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-pod资源共享实现机制"}},[s._v("#")]),s._v(" 1.3 Pod资源共享实现机制")]),s._v(" "),n("ul",[n("li",[s._v("方法1：共享网络\n"),n("ul",[n("li",[s._v("同一个pod中启动多个容器，那么就会使用同一套网络")]),s._v(" "),n("li",[s._v("比如在同一个pod部署两个容器，nginx和busybox")]),s._v(" "),n("li",[s._v("无论是在 在busybox的容器环境中，通过 curl http://127.0.0.1:80 可以访问到nginx页面")])])]),s._v(" "),n("li",[s._v("方法2：数据卷共享数据\n"),n("ul",[n("li",[s._v("在同一pod中启动多个容器，多个容器挂载同一个数据卷")]),s._v(" "),n("li",[s._v("挂载数据卷的这个文件夹在容器内部就可以用来共享数据")])])])]),s._v(" "),n("p",[n("img",{staticStyle:{width:"800px","margin-left":"20px"},attrs:{src:a(647)}})]),s._v(" "),n("h2",{attrs:{id:"_1-4-pod管理命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-pod管理命令"}},[s._v("#")]),s._v(" 1.4 Pod管理命令")]),s._v(" "),n("h3",{attrs:{id:"_1-4-1-导出创建pod的yaml"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-1-导出创建pod的yaml"}},[s._v("#")]),s._v(" 1.4.1 导出创建pod的YAML")]),s._v(" "),n("ul",[n("li",[s._v("导出创建pod的YAML文件")])]),s._v(" "),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("#  kubectl "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("get")]),s._v(" pods\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("#  kubectl "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("get")]),s._v(" pods web"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("674477549")]),s._v("d"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("d6zc "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("o yaml "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" pod"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("yaml\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("#  cat pod"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("yaml     # 删除 pod"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("yaml中多余内容，只留下一些内容\n \napiVersion"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" v1\nkind"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" Pod\nmetadata"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n  labels"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n    app"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" web\n  name"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" web"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("674477549")]),s._v("d"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("d6zc\n  namespace"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v("\nspec"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n  containers"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" image"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" lizhenliang"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("java"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("demo\n    imagePullPolicy"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" Always\n    name"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" java"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("demo\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("h3",{attrs:{id:"_1-4-2-共享网络：共享数据"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-2-共享网络：共享数据"}},[s._v("#")]),s._v(" 1.4.2 共享网络：共享数据")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("部署busybox和nginx两个容器")])]),s._v(" "),n("li",[n("p",[s._v("修改创建pod的YAML文件，完成部署busybox和nginx两个容器")])])]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("master ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim pod-net-test.yaml")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Pod\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("labels")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("app")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" test\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" pod"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("net"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("test\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("namespace")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" default\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" busybox\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" test\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" web\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])]),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# kubectl apply "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("f pod"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("net"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("test"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("yaml         # 部署pod\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# kubectl "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("delete")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("f pod"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("net"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("test"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("yaml         # 删除刚刚部署的pod \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# kubectl "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("get")]),s._v(" pod "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("w                    # 查看当前pod状态\n"),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NAME")]),s._v("        "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("READY")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("STATUS")]),s._v("    "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("RESTARTS")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("AGE")]),s._v("\npod"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("net"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("test   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("    Running    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("29")]),s._v("s\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# kubectl describe pod pod"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("net"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("test          # 查看pod详细日志信息\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("ul",[n("li",[s._v("测试在busybox容器中可以通过http://127.0.0.1:80 访问nginx容器的页面")])]),s._v(" "),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# kubectl exec "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("it pod"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("net"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("test "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("c test "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v(" sh     # 进入busybox容器\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" # wget http"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("                      # 在busybox容器中可以正常访问nginx的页面\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# kubectl exec "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("it pod"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("net"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("test "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("c web "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v(" sh     # 进入nginx容器 \n# echo "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'nginx'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("share"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("html"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("index"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("html        # 可以修改nginx网站页面，在busybox可以正常到修改后的内容\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h3",{attrs:{id:"_1-4-3-volume共享数据"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-3-volume共享数据"}},[s._v("#")]),s._v(" 1.4.3 volume共享数据")]),s._v(" "),n("ul",[n("li",[s._v("修改创建pod的YAML文件，添加数据卷，完成部署busybox和nginx两个容器")])]),s._v(" "),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# vim pod"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("volume"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("test"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("yaml \n\napiVersion"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" v1\nkind"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" Pod\nmetadata"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n  labels"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n    app"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" test\n  name"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" pod"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("volume"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("test\n  namespace"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v("\nspec"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n  containers"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" image"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" busybox\n    name"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" test\n    command"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/sh"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-c"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sleep 360000"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    volumeMounts"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" name "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" log\n      mountPath"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("data\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" image"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" nginx\n    name"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" web\n    volumeMounts"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" name "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" log\n      mountPath"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("data\n\n  volumes"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" name"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" log\n    emptyDir"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br")])]),n("ul",[n("li",[s._v("部署pod")])]),s._v(" "),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# kubectl apply "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("f pod"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("volume"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("test"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("yaml          # 部署pod\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# kubectl "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("delete")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("f pod"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("volume"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("test"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("yaml          # 删除刚刚部署的pod \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# kubectl "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("get")]),s._v(" pod "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("w                       # 查看当前pod状态\n"),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NAME")]),s._v("           "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("READY")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("STATUS")]),s._v("    "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("RESTARTS")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("AGE")]),s._v("\npod"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("volume"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("test   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("     Running   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("        "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("m59s\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# kubectl describe pod pod"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("volume"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("test          # 查看pod详细日志信息\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("ul",[n("li",[s._v("测试pod通过volume来共享文件夹")])]),s._v(" "),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# kubectl exec "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("it pod"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("volume"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("test "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("c test "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v(" sh     # 进入busybox容器\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" # cd "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("data            # 在busybox容器中的"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("data文件夹和nginx容器文件夹共享，在其中一个容器修改，在另一个容器中可以看到\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# kubectl exec "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("it pod"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("volume"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("test "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("c web "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v(" sh     # 进入nginx容器 \n# cd "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("data             # 在busybox容器中的"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("data文件夹和nginx容器文件夹共享，在其中一个容器修改，在另一个容器中可以看到\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h2",{attrs:{id:"_1-5-重启策略-健康检查（应用自修复）"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-重启策略-健康检查（应用自修复）"}},[s._v("#")]),s._v(" 1.5 重启策略+健康检查（应用自修复）")]),s._v(" "),n("h3",{attrs:{id:"_1-5-1-重启策略"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-1-重启策略"}},[s._v("#")]),s._v(" 1.5.1 重启策略")]),s._v(" "),n("ul",[n("li",[n("p",[n("code",[s._v("Always")]),s._v("：当容器终止退出后，总是重启容器，默认策略。")])]),s._v(" "),n("li",[n("p",[s._v("OnFailure：当容器异常退出（退出状态码非0）时，才重启容器。")])]),s._v(" "),n("li",[n("p",[s._v("Never：当容器终止退出，从不重启容器。")])])]),s._v(" "),n("h3",{attrs:{id:"_1-5-2-健康检查有以下两种类型"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-2-健康检查有以下两种类型"}},[s._v("#")]),s._v(" 1.5.2 健康检查有以下两种类型")]),s._v(" "),n("ul",[n("li",[s._v("livenessProbe（存活检查）：如果检查失败，将杀死容器，根据Pod 的restartPolicy来操作。")]),s._v(" "),n("li",[s._v("readinessProbe（就绪检查）：如果检查失败，Kubernetes会把 Pod从service endpoints中剔除。")]),s._v(" "),n("li",[s._v("startupProbe（启动检查）：")])]),s._v(" "),n("p",[n("img",{staticStyle:{width:"400px","margin-left":"20px"},attrs:{src:a(648)}})]),s._v(" "),n("h3",{attrs:{id:"_1-5-3-支持以下三种检查方法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-3-支持以下三种检查方法"}},[s._v("#")]),s._v(" 1.5.3 支持以下三种检查方法")]),s._v(" "),n("ul",[n("li",[s._v("httpGet：发送HTTP请求，返回200-400范围状态码为成功。")]),s._v(" "),n("li",[s._v("exec：执行Shell命令返回状态码是0为成功。")]),s._v(" "),n("li",[s._v("tcpSocket：发起TCP Socket建立成功。")])]),s._v(" "),n("h3",{attrs:{id:"_1-5-4-重启策略-健康检查"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-4-重启策略-健康检查"}},[s._v("#")]),s._v(" 1.5.4 重启策略+健康检查")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("在官网搜索 readlinessProbe 关键字，可以看到官方示例")])]),s._v(" "),n("li",[n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[s._v("  https"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("kubernetes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("zh"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("docs"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("tasks"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("configure"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("pod"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("container"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("configure"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("liveness"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("readiness"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("startup"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("probes"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])]),s._v(" "),n("li",[n("p",[n("img",{staticStyle:{width:"600px","margin-left":"20px"},attrs:{src:a(649)}})])])]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("master ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim pod-check.yaml")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Pod\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("labels")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("test")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" liveness\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" pod"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("check\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" liveness\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" busybox\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("args")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" /bin/sh\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("c\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" touch /tmp/healthy; sleep 30; rm "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("rf /tmp/healthy; sleep 600\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("livenessProbe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("command")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" cat\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" /tmp/healthy\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("initialDelaySeconds")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("     "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 容器启动多少秒后进行健康检查")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("periodSeconds")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("         "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 每个多少秒进行健康检查")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br")])]),n("ul",[n("li",[s._v("部署后即可看到健康检查失败后会自动重启")])]),s._v(" "),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# kubectl apply  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("f pod"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("check"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("yaml\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# kubectl "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("get")]),s._v(" pods\n"),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NAME")]),s._v("       "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("READY")]),s._v("    "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("STATUS")]),s._v("    "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("RESTARTS")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("AGE")]),s._v("\npod"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("check    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("     Running    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("34")]),s._v("s\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("master "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# kubectl describe pod pod"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("check     # 可以看到健康检查发现异常，会自动重启\nfailed"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" cat"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" can"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'t open '")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("tmp"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("healthy'"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" No such file or directory\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h2",{attrs:{id:"_1-6-pod注入环境变量"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-6-pod注入环境变量"}},[s._v("#")]),s._v(" 1.6 Pod注入环境变量")]),s._v(" "),n("ul",[n("li",[s._v("变量值几种定义方式：\n"),n("ul",[n("li",[s._v("自定义变量值")]),s._v(" "),n("li",[s._v("变量值从Pod属性获取")]),s._v(" "),n("li",[s._v("变量值从Secret、ConfigMap获取")])])])]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Pod\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" pod"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("envars\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" test\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" busybox\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("command")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sh"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-c"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sleep 36000"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("env")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" MY_NODE_NAME\n          "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("valueFrom")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("fieldRef")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n              "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("fieldPath")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" spec.nodeName\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" MY_POD_NAME\n          "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("valueFrom")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("fieldRef")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n              "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("fieldPath")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" metadata.name\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" MY_POD_NAMESPACE\n          "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("valueFrom")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("fieldRef")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n              "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("fieldPath")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" metadata.namespace\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" MY_POD_IP\n          "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("valueFrom")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("fieldRef")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("fieldPath")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" status.podIP\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ABC\n          "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br")])]),n("h2",{attrs:{id:"_1-7-init-container"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-7-init-container"}},[s._v("#")]),s._v(" 1.7 Init Container")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("Init Container：顾名思义，用于初始化工作，执行完就结束，可以理解为一次性任务。")]),s._v(" "),n("ul",[n("li",[s._v("支持大部分应用容器配置，但不支持健康检查")]),s._v(" "),n("li",[s._v("优先应用容器执行")])])]),s._v(" "),n("li",[n("p",[s._v("应用场景：")]),s._v(" "),n("ul",[n("li",[s._v("环境检查：例如确保应用容器依赖的服务启动后再启动应用容器")]),s._v(" "),n("li",[s._v("初始化配置：例如给应用容器准备配置文件")])])]),s._v(" "),n("li",[n("p",[s._v("示例：部署一个web网站，网站程序没有打到镜像中，而是希望从代码 仓库中动态拉取放到应用容器中。")])])]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Pod\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" init"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("demo\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("initContainers")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" download\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" busybox\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("command")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" wget\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-O"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/opt/index.html"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" http"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//www.ctnrs.com\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumeMounts")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" wwwroot\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("mountPath")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/opt"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containerPort")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumeMounts")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" wwwroot\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("mountPath")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" /usr/share/nginx/html\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" wwwroot\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("emptyDir")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br")])]),n("ul",[n("li",[s._v("因此，Pod中会有这几种类型的容器：\n"),n("ul",[n("li",[s._v("Infrastructure Container：基础容器\n"),n("ul",[n("li",[s._v("维护整个Pod网络空间")])])]),s._v(" "),n("li",[s._v("InitContainers：初始化容器\n"),n("ul",[n("li",[s._v("先于业务容器开始执行")])])]),s._v(" "),n("li",[s._v("Containers：业务容器\n"),n("ul",[n("li",[s._v("并行启动")])])])])])])])}),[],!1,null,null,null);t.default=e.exports}}]);